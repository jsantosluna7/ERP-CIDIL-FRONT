<div class="container mt-4">
  <h2 class="mb-3">Solicitudes de Reserva de Equipos</h2>

  <div class="table-scroll">
    @if (solicitud.length > 0) {
    <table
      mat-table
      [dataSource]="solicitud"
      class="mat-elevation-z8 full-width-table"
    >
      <!-- Usuario -->
      <ng-container matColumnDef="nombreUsuario">
        <th mat-header-cell *matHeaderCellDef class="encabezado-azul">
          Usuario
        </th>
        <td mat-cell *matCellDef="let solicitud">
          {{ solicitud.nombreUsuario }}
        </td>
      </ng-container>

      <!-- Equipo -->
      <ng-container matColumnDef="nombreEquipo">
        <th mat-header-cell *matHeaderCellDef class="encabezado-azul">
          Equipo
        </th>
        <td mat-cell *matCellDef="let solicitud">
          {{ solicitud.nombreEquipo }}
        </td>
      </ng-container>

      <!-- Fecha Inicio -->
      <ng-container matColumnDef="fechaInicio">
        <th mat-header-cell *matHeaderCellDef class="encabezado-azul">
          Fecha Inicio
        </th>
        <td mat-cell *matCellDef="let solicitud">
          {{ solicitud.fechaInicio }}
        </td>
      </ng-container>

      <!-- Fecha Final -->
      <ng-container matColumnDef="fechaFinal">
        <th mat-header-cell *matHeaderCellDef class="encabezado-azul">
          Fecha Final
        </th>
        <td mat-cell *matCellDef="let solicitud">{{ solicitud.fechaFinal }}</td>
      </ng-container>

      <!-- Motivo -->
      <ng-container matColumnDef="motivo">
        <th mat-header-cell *matHeaderCellDef class="encabezado-azul">
          Motivo
        </th>
        <td mat-cell *matCellDef="let solicitud">{{ solicitud.motivo }}</td>
      </ng-container>

      <ng-container matColumnDef="cantidad">
        <th mat-header-cell *matHeaderCellDef class="encabezado-azul">
          Cantidad
        </th>
        <td mat-cell *matCellDef="let solicitud">{{ solicitud.cantidad }}</td>
      </ng-container>

      <!-- Estado -->
      <ng-container matColumnDef="estado">
        <th mat-header-cell *matHeaderCellDef class="encabezado-azul">
          Estado
        </th>
        <td mat-cell *matCellDef="let solicitud">
          {{
            solicitud.idEstado === 1
              ? "Aprobado"
              : solicitud.idEstado === 3
              ? "Rechazado"
              : "Pendiente"
          }}
        </td>
      </ng-container>

      <!-- Acciones -->
      <ng-container matColumnDef="acciones">
        <th mat-header-cell *matHeaderCellDef class="encabezado-azul">
          Acciones
        </th>
        <td mat-cell *matCellDef="let solicitud">
          <button
            mat-raised-button
            color="primary"
            class="botones-green"
            (click)="aprobar(solicitud)"
            [disabled]="loading[solicitud.id]?.aprobar"
          >
            @if (loading[solicitud.id]?.aprobar) {
            <mat-progress-spinner
              mode="indeterminate"
              diameter="30"
              strokeWidth="3"
              class="white-spinner"
            ></mat-progress-spinner>
            } @else {
            <span>Aprobar</span>
            }
          </button>
          <button
            mat-raised-button
            color="warn"
            class="botones-red"
            (click)="desaprobar(solicitud)"
            [disabled]="loading[solicitud.id]?.denegar"
          >
            @if (loading[solicitud.id]?.denegar) {
            <mat-progress-spinner
              mode="indeterminate"
              diameter="30"
              strokeWidth="3"
              class="white-spinner"
            ></mat-progress-spinner>
            } @else {
            <span>Negar</span>
            }
          </button>
        </td>
      </ng-container>

      <!-- Filas -->
      <tr mat-header-row *matHeaderRowDef="columnas"></tr>
      <tr mat-row *matRowDef="let solicitud; columns: columnas"></tr>
    </table>
    } @else {
    <div class="alert alert-info">No hay solicitudes disponibles.</div>
    }
  </div>
</div>
